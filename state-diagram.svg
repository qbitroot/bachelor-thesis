<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="STATE" height="721.2197px" preserveAspectRatio="none" style="width:800px;height:721px;background:#FFFFFF;" version="1.1" viewBox="0 0 800 721" width="800.5131px" zoomAndPan="magnify"><defs/><g><!--cluster H3_EST--><g class="cluster" data-entity="H3_EST" data-source-line="4" data-uid="ent0002" id="cluster_H3_EST"><path d="M399.4753,47.2262 L614.6168,47.2262 A7.288,7.288 0 0 1 621.9048,54.5142 L621.9048,69.1448 L392.1873,69.1448 L392.1873,54.5142 A7.288,7.288 0 0 1 399.4753,47.2262" fill="#F1F1F1"/><rect fill="none" height="287.1236" rx="7.288" ry="7.288" style="stroke:#181818;stroke-width:0.2915;" width="229.7175" x="392.1873" y="47.2262"/><line style="stroke:#181818;stroke-width:0.2915;" x1="392.1873" x2="621.9048" y1="69.1448" y2="69.1448"/><text fill="#000000" font-family="sans-serif" font-size="8.1626" font-weight="bold" lengthAdjust="spacing" textLength="143.3389" x="435.3766" y="57.135">HTTP/3 Connection Established</text><text fill="#000000" font-family="sans-serif" font-size="8.1626" lengthAdjust="spacing" textLength="117.0736" x="448.5092" y="66.6367">(QUIC Handshake Complete)</text></g><g id="H3_EST.WAIT_SETTINGS"><rect fill="#F1F1F1" height="37.4512" rx="7.288" ry="7.288" style="stroke:#181818;stroke-width:0.2915;" width="180.6864" x="406.2094" y="117.6107"/><line style="stroke:#181818;stroke-width:0.2915;" x1="406.2094" x2="586.8958" y1="132.9428" y2="132.9428"/><text fill="#000000" font-family="sans-serif" font-size="8.1626" lengthAdjust="spacing" textLength="68.4331" x="462.336" y="128.1026">Wait for Settings</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="101.8349" x="409.1246" y="142.3523">Client/Server must exchange</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="169.0256" x="409.1246" y="150.4966">SETTINGS_WEBTRANSPORT_MAX_SESSIONS &gt; 0</text></g><g id="H3_EST.IDLE"><rect fill="#F1F1F1" height="29.3068" rx="7.288" ry="7.288" style="stroke:#181818;stroke-width:0.2915;" width="114.2507" x="422.517" y="199.9592"/><line style="stroke:#181818;stroke-width:0.2915;" x1="422.517" x2="536.7676" y1="215.2913" y2="215.2913"/><text fill="#000000" font-family="sans-serif" font-size="8.1626" font-weight="bold" lengthAdjust="spacing" textLength="17.2139" x="471.0354" y="210.451">Idle</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="102.5899" x="425.4322" y="224.7008">Ready to request WT Session</text></g><g id="H3_EST.CONNECTING"><rect fill="#F1F1F1" height="37.4512" rx="7.288" ry="7.288" style="stroke:#181818;stroke-width:0.2915;" width="155.5838" x="405.9353" y="282.9024"/><line style="stroke:#181818;stroke-width:0.2915;" x1="405.9353" x2="561.5192" y1="298.2345" y2="298.2345"/><text fill="#000000" font-family="sans-serif" font-size="8.1626" font-weight="bold" lengthAdjust="spacing" textLength="51.9486" x="457.753" y="293.3942">Connecting</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="143.923" x="408.8505" y="307.644">Client sends extended CONNECT request</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="99.8637" x="408.8505" y="315.7883">Waiting for Server Response</text></g><g id="OPEN"><rect fill="#F1F1F1" height="53.7398" rx="7.288" ry="7.288" style="stroke:#181818;stroke-width:0.2915;" width="148.7001" x="218.1384" y="413.474"/><line style="stroke:#181818;stroke-width:0.2915;" x1="218.1384" x2="366.8385" y1="428.8062" y2="428.8062"/><text fill="#000000" font-family="sans-serif" font-size="8.1626" font-weight="bold" lengthAdjust="spacing" textLength="62.3192" x="261.3288" y="423.9659">Session Open</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" font-weight="bold" lengthAdjust="spacing" textLength="99.4879" x="221.0536" y="438.2156">Main Data Transfer State</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="5.0492" x="221.0536" y="446.36">--</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="137.0393" x="221.0536" y="454.5043">Stream 0x54 (Uni), Stream 0x41 (Bidi),</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="102.4737" x="221.0536" y="462.6486">Datagrams, Control Capsules</text></g><g id="DRAINING"><rect fill="#F1F1F1" height="37.4512" rx="7.288" ry="7.288" style="stroke:#181818;stroke-width:0.2915;" width="147.2311" x="47.4594" y="549.8353"/><line style="stroke:#181818;stroke-width:0.2915;" x1="47.4594" x2="194.6905" y1="565.1674" y2="565.1674"/><text fill="#000000" font-family="sans-serif" font-size="8.1626" font-weight="bold" lengthAdjust="spacing" textLength="39.37" x="101.39" y="560.3272">Draining</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="66.733" x="50.3746" y="574.5769">Graceful Shutdown</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="135.5703" x="50.3746" y="582.7212">(One side stops creating new streams)</text></g><g id="CLOSED"><rect fill="#F1F1F1" height="37.4512" rx="7.288" ry="7.288" style="stroke:#181818;stroke-width:0.2915;" width="82.1755" x="251.4008" y="632.1838"/><line style="stroke:#181818;stroke-width:0.2915;" x1="251.4008" x2="333.5763" y1="647.5159" y2="647.5159"/><text fill="#000000" font-family="sans-serif" font-size="8.1626" font-weight="bold" lengthAdjust="spacing" textLength="30.6335" x="277.1718" y="642.6756">Closed</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="69.343" x="254.3159" y="656.9254">Session Terminated</text><text fill="#000000" font-family="sans-serif" font-size="6.9965" lengthAdjust="spacing" textLength="70.5147" x="254.3159" y="665.0697">Resources Released</text></g><ellipse cx="496.5513" cy="9.3286" fill="#222222" rx="5.8304" ry="5.8304" style="stroke:#222222;stroke-width:0.583;"/><ellipse cx="292.4875" cy="711.6112" fill="none" rx="6.4134" ry="6.4134" style="stroke:#222222;stroke-width:0.583;"/><ellipse cx="292.4875" cy="711.6112" fill="#222222" rx="3.4982" ry="3.4982" style="stroke:#222222;stroke-width:0.583;"/><g class="entity" data-entity="GMN2" data-source-line="43" data-uid="ent0003" id="entity_GMN2"><path d="M3.4982,384.4912 L3.4982,496.1979 A0,0 0 0 0 3.4982,496.1979 L197.8391,496.1979 A0,0 0 0 0 197.8391,496.1979 L197.8391,442.6727 L217.9926,440.3405 L197.8391,438.0083 L197.8391,390.3215 L192.0087,384.4912 L3.4982,384.4912 A0,0 0 0 0 3.4982,384.4912" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.2915;"/><path d="M192.0087,384.4912 L192.0087,390.3215 L197.8391,390.3215 L192.0087,384.4912" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.2915;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="121.9569" x="6.9965" y="394.4418">Fuzzing Focus (OPEN State):</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="2.4093" x="6.9965" y="403.2648">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="182.097" x="6.9965" y="412.0879">1. Control Capsules (via CONNECT Stream)</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="142.4822" x="6.9965" y="420.9109">[Type (VarInt)][Len (VarInt)][Payload]</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="2.4093" x="6.9965" y="429.7339">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="178.4997" x="6.9965" y="438.557">2. New Data Streams (Raw QUIC streams)</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="105.336" x="6.9965" y="447.38">Start with session ID signal:</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-style="italic" lengthAdjust="spacing" textLength="15.011" x="6.9965" y="456.203">Uni:</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="77.4087" x="24.4168" y="456.203">[0x54][Session ID]...</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-style="italic" lengthAdjust="spacing" textLength="16.7763" x="6.9965" y="465.026">Bidi:</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="77.4087" x="26.1821" y="465.026">[0x41][Session ID]...</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="2.4093" x="6.9965" y="473.8491">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="57.6235" x="6.9965" y="482.6721">3. Datagrams</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="111.4906" x="6.9965" y="491.4951">[Quarter Stream ID][Payload]</text></g><!--link *start* to H3_EST--><g class="link" data-entity-1=".start." data-entity-2="H3_EST" data-link-type="dependency" data-source-line="18" data-uid="lnk3" id="link_.start._H3_EST"><path d="M496.5513,15.4156 C496.5513,19.1514 496.5513,24.4709 496.5513,30.3683 C496.5513,33.3171 496.5513,36.4103 496.5513,39.5222 C496.5513,41.0782 496.5513,42.6389 496.5513,44.1886 C496.5513,44.9634 496.5513,45.7355 496.5513,46.5028 C496.5513,46.6946 496.5513,43.388 496.5513,43.5792" fill="none" id="*start*-to-H3_EST" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="496.5513,47.0774,498.8835,41.83,496.5513,44.1622,494.2192,41.83,496.5513,47.0774" style="stroke:#181818;stroke-width:0.583;"/></g><!--link H3_EST to WAIT_SETTINGS--><g class="link" data-entity-1="H3_EST" data-entity-2="WAIT_SETTINGS" data-link-type="dependency" data-source-line="20" data-uid="lnk4" id="link_H3_EST_WAIT_SETTINGS"><path d="M496.5513,72.8974 C496.5513,75.2296 496.5513,96.1374 496.5513,113.8384" fill="none" id="H3_EST-to-WAIT_SETTINGS" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="496.5513,117.3367,498.8835,112.0893,496.5513,114.4215,494.2192,112.0893,496.5513,117.3367" style="stroke:#181818;stroke-width:0.583;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="50.477" x="497.1344" y="97.8264">TLS 1.3 Done</text></g><!--link WAIT_SETTINGS to IDLE--><g class="link" data-entity-1="WAIT_SETTINGS" data-entity-2="IDLE" data-link-type="dependency" data-source-line="21" data-uid="lnk5" id="link_WAIT_SETTINGS_IDLE"><path d="M492.5458,155.1934 C489.5548,168.8191 486.2803,183.7559 483.5284,196.3204" fill="none" id="WAIT_SETTINGS-to-IDLE" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="482.7799,199.7376,486.1808,195.1108,483.4036,196.8899,481.6245,194.1128,482.7799,199.7376" style="stroke:#181818;stroke-width:0.583;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="74.6848" x="488.9718" y="180.1749">SETTINGS Received</text></g><!--link IDLE to CONNECTING--><g class="link" data-entity-1="IDLE" data-entity-2="CONNECTING" data-link-type="dependency" data-source-line="23" data-uid="lnk6" id="link_IDLE_CONNECTING"><path d="M480.3195,229.3735 C481.0133,243.9437 481.9259,263.2054 482.6839,279.1574" fill="none" id="IDLE-to-CONNECTING" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="482.8499,282.6517,484.9304,277.2995,482.7115,279.7398,480.2713,277.5209,482.8499,282.6517" style="stroke:#181818;stroke-width:0.583;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="95.7839" x="524.3954" y="254.3724">Client sends CONNECT</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="180.6241" x="481.9753" y="263.1955">:method = CONNECT, :protocol = webtransport</text></g><!--link CONNECTING to OPEN--><g class="link" data-entity-1="CONNECTING" data-entity-2="OPEN" data-link-type="dependency" data-source-line="25" data-uid="lnk7" id="link_CONNECTING_OPEN"><path d="M458.1349,320.6192 C425.0532,344.413 370.0672,383.9584 332.2396,411.1689" fill="none" id="CONNECTING-to-OPEN" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="329.3998,413.2117,335.0214,412.0407,331.7663,411.5094,332.2977,408.2543,329.3998,413.2117" style="stroke:#181818;stroke-width:0.583;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="89.1962" x="459.7649" y="355.9612">Server sends 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="175.3761" x="416.6749" y="364.7843">(Session ID = Stream ID of CONNECT request)</text></g><!--link CONNECTING to CLOSED--><g class="link" data-entity-1="CONNECTING" data-entity-2="CLOSED" data-link-type="dependency" data-source-line="27" data-uid="lnk8" id="link_CONNECTING_CLOSED"><path d="M561.5369,319.6688 C575.4657,326.3505 588.2576,335.58 596.8341,348.3427 C615.4622,376.0604 796.5018,339.1832 584.5903,587.2897 C552.4998,624.8608 409.9056,641.1304 337.253,647.1474" fill="none" id="CONNECTING-to-CLOSED" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="333.7667,647.4361,339.1887,649.3272,336.672,647.1955,338.8037,644.6788,333.7667,647.4361" style="stroke:#181818;stroke-width:0.583;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="81.9905" x="640.562" y="525.6782">Server sends 4xx/5xx</text></g><!--link OPEN to OPEN--><g class="link" data-entity-1="OPEN" data-entity-2="OPEN" data-link-type="dependency" data-source-line="30" data-uid="lnk9" id="link_OPEN_OPEN"><path d="M366.9708,426.0327 C378.9989,428.1025 387.2431,432.8776 387.2431,440.3405 C387.2431,447.8092 382.4462,451.9836 370.4181,454.0592" fill="none" id="OPEN-to-OPEN" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="366.9708,454.6541,372.5383,456.06,369.8436,454.1584,371.7452,451.4636,366.9708,454.6541" style="stroke:#181818;stroke-width:0.583;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="44.204" x="390.7413" y="443.0032">Send Data</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="108.5447" x="437.3546" y="443.0032">(Self-Loop for Data Transfer)</text></g><!--link OPEN to DRAINING--><g class="link" data-entity-1="OPEN" data-entity-2="DRAINING" data-link-type="dependency" data-source-line="32" data-uid="lnk10" id="link_OPEN_DRAINING"><path d="M259.3767,467.4227 C244.4742,478.0223 226.161,489.3275 207.9468,496.1957 C182.3514,505.8508 104.0084,493.0123 86.0916,513.6868 C76.4714,524.7879 83.3326,536.3255 94.7893,547.3041" fill="none" id="OPEN-to-DRAINING" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="97.3151,549.7245,95.14,544.4101,95.2103,547.7075,91.9129,547.7778,97.3151,549.7245" style="stroke:#181818;stroke-width:0.583;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="80.9875" x="141.4485" y="521.3054">Send/Recv Capsule</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="190.5352" x="86.6746" y="530.1284">DRAIN_WEBTRANSPORT_SESSION (Type=0x78AE)</text></g><!--link OPEN to CLOSED--><g class="link" data-entity-1="OPEN" data-entity-2="CLOSED" data-link-type="dependency" data-source-line="34" data-uid="lnk11" id="link_OPEN_CLOSED"><path d="M292.4875,467.446 C292.4875,510.5851 292.4875,591.371 292.4875,628.5048" fill="none" id="OPEN-to-CLOSED" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="292.4875,632.003,294.8197,626.7557,292.4875,629.0878,290.1554,626.7557,292.4875,632.003" style="stroke:#181818;stroke-width:0.583;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="71.317" x="400.6364" y="566.8524">Immediate Close</text><text fill="#000000" font-family="sans-serif" font-size="7.5795" lengthAdjust="spacing" textLength="286.4486" x="293.0706" y="575.6754">(CLOSE_WEBTRANSPORT_SESSION Capsule or CONNECT Stream Reset/FIN)</text></g><!--link DRAINING to CLOSED--><g class="link" data-entity-1="DRAINING" data-entity-2="CLOSED" data-link-type="dependency" data-source-line="37" data-uid="lnk12" id="link_DRAINING_CLOSED"><path d="M129.7496,587.5579 C135.0786,596.9857 142.7747,607.8827 152.5581,614.6926 C181.7334,634.9765 218.0321,643.2818 247.7146,647.0482" fill="none" id="DRAINING-to-CLOSED" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="251.185,647.4886,246.273,644.5144,248.293,647.1216,245.6858,649.1416,251.185,647.4886" style="stroke:#181818;stroke-width:0.583;"/><text fill="#000000" font-family="sans-serif" font-size="7.5795" font-weight="bold" lengthAdjust="spacing" textLength="123.6223" x="153.1411" y="612.3994">Timeout or Streams Finished</text></g><!--link CLOSED to *end*--><g class="link" data-entity-1="CLOSED" data-entity-2=".end." data-link-type="dependency" data-source-line="40" data-uid="lnk14" id="link_CLOSED_.end."><path d="M292.4875,669.8365 C292.4875,681.8646 292.4875,693.3271 292.4875,701.5013" fill="none" id="CLOSED-to-*end*" style="stroke:#181818;stroke-width:0.583;"/><polygon fill="#181818" points="292.4875,704.9996,294.8197,699.7522,292.4875,702.0844,290.1554,699.7522,292.4875,704.9996" style="stroke:#181818;stroke-width:0.583;"/></g><!--SRC=[TLLjRzf84FxkNp7gbu8LNjAakWerI1H8OnqrANOl9mKKRUm1LcVl-dRNWVJK_zvPlyMalNm9xCm-yymppomwOWd2X-4G3ZmsUsVFOmHCC_CCCUf8ySnmAHn76sOGtdny7D-4uUtW0gPI28ni4EOKV4outcFySV0uNelErs_U56wOYFMU_OEKcsO96ko-0QRXvk9X7eJmdmFqL-7UCMvWAnK4Q0mNErratasyy26OXw7dVmvW1DE4ep230DKJAaXpRG2FqPw97Qv5dVTmD_yKhYP-SBjSXGzV9dyJGX1uIp-0CGoTTbNgneiJjAIBUjviCQSoAsJnCnW92l_DaOhSXSHBwqA8q-kr2cBNW4oNlZ-VMYeDOz18KX1NG_ynhbDg_BMmxHD6fK3HtGfr9eL6vqTR_8e6B3CKJSNbxTodMXJ-mhY06JCCGiM4tX9EOE-MO-drI2MZaAKmFBw_XCutmRjdq1nTdaFd4u_fR2qio4wnL9_PIHib4vYoJES9wZQVcQAAxUvdguddbxr_LYp2RPv0iCzDB0-2ZB4K2DfQJ1kPQOYeSj6um0CTMHwwsyQV9bANhYgrNIo3-OomQnr2L2aNb1sl1IacSnMX9kqIP7JFSUxT3VHwuyfpZbDvpnwzDbUu2E2yVm4pAT0v3ThqoXlDsGeZv4-sHX6nAIUJByYtXby5oqcCKZHx6SDLVNm6eqn98oFI-GeE-6Zi_3AfZEEqO6sLbsbNJYdntz4AB_-izg-MnviHMZLV-YothwtN_GM-9N4B_V9u7Bm_7XtdRQ_NAyt5xUvhs2gPbfmeyjQfFZKqNJSWWCAJhWj4BDds5b9cXTLFd4fKciij5vK00vBxgNQWwv8_RSRfgbTh3ftmESEhuV6F3vDv6xJfp7MzDCMOMvCL1hE0dIByUyIgBX3bMhzALF8Sci6rvtV_JvgcbKAUrhSJGY5FKUR6LYYHDLpJOjadrNKhQ3fWIRdF9LXrtqAHpnr7I8eak3LsqBPjUgp89jVvz-zsnwvbb6le57eKADsHjGibbNdd_LzM7JfFdBtgkLjTkhSoG-SlfZnXkflx1OhMjrlsd4WMRnhqTttmQScBaTSjTbRi0CLlHRtx5JRHKuP-aSoU_DTOMVCTAJ2oU7nCRnVHvzIwVSiszo-Mt_Jx_JB7FcPDqkNvRv9ARXTzQDwxkhklEL50zR8zhPwiewtOFm40]--></g></svg>